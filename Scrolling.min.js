var Scrolling=Scrolling||(function(){var c={forEach:function(h,g){if("forEach" in h){return h.forEach(g)}if(h instanceof Array||!!h.length){for(var f=0,e=h.length;f<e;){g.call(h[f],h[f],f++)}}else{for(var f in h){g.call(h[f],h[f],f)}}},query:(function(){var g=function(h,i){return h.nodeType?[h]:(i||document).querySelectorAll(h)};var f=function(h,i){return $(h,(i||null)).toArray()};var e=function(h,i){return[h+" - dependency required"]};return !!document.querySelectorAll?g:!!window.jQuery?f:e})(),bind:(function(e){return e?function(h,f,g){h["evt"+f+g]=g;h[f+g]=function(){h["evt"+f+g](window.event)};h.attachEvent("on"+f,h[f+g])}:function(h,f,g){h.addEventListener(f,g,false)}})(window.attachEvent),getOffset:function(h){if(!h){return{top:0,left:0}}var f=0,g=0,e=h;while(e){f+=e.offsetLeft;g+=e.offsetTop;e=e.offsetParent}return{top:g,left:f}}};var d=(function(g){var f=function(){return{x:window.scrollX,y:window.scrollY}};var e=function(){return{x:g.scrollLeft,y:g.scrollTop}};return typeof window.scrollY==="number"?f:e})(document.documentElement);var b=(function(){var e=function(f){this.domNode=f;this.setData();this.debugmode=false;this.position={x:0,y:0};this.visible=false;this.scrollPercent={x:0,y:0}};e.prototype={debug:function(){if(this.debugmode){return}this.debugmode=true;var f;var k=(Math.floor(Math.random()*16777215)).toString(16);var l="#"+k;var g=document.createElement("div");var j=document.createElement("div");var i={position:"fixed",zIndex:99999,background:"#000",color:l,padding:"1em",font:'12px/1.4em "Consolas", "Courier New", monospace'};for(f in i){g.style[f]=i[f]}i={position:"fixed",background:"rgba(20,20,20,0.2)",zIndex:99998,border:"2px solid "+l,width:this.width+"px",height:this.height+"px",top:"0px",left:"0px"};for(f in i){j.style[f]=i[f]}document.body.appendChild(g);document.body.appendChild(j);var h=this.onScroll;this.onScroll=function(){if(!this.visible){g.style.display="none";j.style.display="none";return}else{g.style.display="block";j.style.display="block"}var m="position: {x: "+this.position.x+", y: "+this.position.y+"}<br />";m+="Scroll range: {x: "+this.scrollRange.x+", y: "+this.scrollRange.y+"}<br />";m+="Scroll completion: { x: "+parseInt(this.scrollPercent.x*100000)/1000+"%, ";m+="y:"+parseInt(this.scrollPercent.y*100000)/1000+"%<br />";m+="offset: {top: "+this.offset.top+", left: "+this.offset.left+"}<br />";m+="width: "+this.width+"px <br />height: "+this.height+"<br />";g.innerHTML=m;g.style.top=j.style.top=this.position.y+"px";g.style.left=j.style.left=this.position.x+"px";h.call(this)}},setData:function(){this.offset=c.getOffset(this.domNode);this.height=this.domNode.clientHeight;this.width=this.domNode.clientWidth;this.scrollRange={x:Scrolling.viewport.width+this.width,y:Scrolling.viewport.height+this.height}},update:function(){this.position={x:this.offset.left-Scrolling.position.x,y:this.offset.top-Scrolling.position.y};this.scrollPercent={x:(Scrolling.viewport.width-this.position.x)/this.scrollRange.x,y:(Scrolling.viewport.height-this.position.y)/this.scrollRange.y};var f=this.visible;this.isVisible();this.onScroll();if(this.visible){this.onVisible.call(this)}if(this.visible!==f){this.onVisibilityChange.call(this);Scrolling.onWaypointChanged(this)}},isVisible:function(){return this.visible=(this.position.y+this.height>0&&this.position.y<Scrolling.viewport.height&&this.position.x+this.width>=0&&this.position.x<Scrolling.viewport.width)},onScroll:function(){},onVisible:function(){},onVisibilityChange:function(){}};return e})();var a=function(){var e=this;this.applied=false;this.directions={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right"};this.direction={x:this.directions.RIGHT,y:this.directions.DOWN};this.position={x:0,y:0};this.debugmode=false;this.viewport={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight};this.visible={width:this.viewport.width,height:this.viewport.height};this.waypoints=[];this.queue=[];c.bind(window,"load",function(){e.applied=true;c.forEach(e.queue,function(){e.queue.splice(0,1)[0].setData()});c.bind(window,"scroll",function(){e.update()});document.documentElement.className+=" scroll-loaded";e.update();e.onLoad()})};a.prototype={debug:function(){if(this.debugmode){return}this.debugmode=true;var h=this.waypoints.length;var e;var f=document.createElement("div");var j={position:"fixed",zIndex:99999,top:"0px",right:"0px",background:"#000",color:"#fff",padding:"1em",font:'12px/1.4em "Consolas", "Courier New", monospace'};for(e in j){f.style[e]=j[e]}document.body.appendChild(f);while(h--){this.waypoints[h].debug()}var g=this.onScroll;this.onScroll=function(){var i="position: {x: "+this.position.x+", y: "+this.position.y+"}<br />";i+="viewport: {width: "+this.viewport.width+", height: "+this.viewport.height+"}<br />";i+="visible: {width: "+this.visible.width+", height: "+this.visible.height+"}<br />";i+="direction: {x: "+this.direction.x+", y: "+this.direction.y+"}<br />";f.innerHTML=i;g.call(this)};window.scroll(Scrolling.position.x+1,Scrolling.position.y+1);window.scroll(Scrolling.position.x-1,Scrolling.position.y-1)},update:function(){var f={x:this.position.x,y:this.position.y};this.position=d();this.viewport={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight};this.visible={height:this.viewport.height+this.position.y,width:this.viewport.width+this.position.x};if(this.position.x>f.x){this.direction.x=this.directions.RIGHT}else{if(this.position.x<f.x){this.direction.x=this.directions.LEFT}}if(this.position.y>f.y){this.direction.y=this.directions.DOWN}else{if(this.position.y<f.y){this.direction.y=this.directions.UP}}var e=this.waypoints.length;while(e--){this.waypoints[e].update()}this.onScroll.call(this)},addWaypoint:function(e){var f=this;if(typeof e==="string"){c.forEach(c.query(e),function(i){var h=new b(i);if(f.debugmode){h.debug()}h.uid=f.waypoints.length;f.waypoints.push(h);if(!f.applied){f.queue.push(h)}})}else{if("nodeName" in e){var g=new b(e);if(f.debugmode){g.debug()}g.uid=f.waypoints.length;f.waypoints.push(g);if(!f.applied){f.queue.push(g)}return g}else{c.forEach(e,function(i){var h=new b(i);if(f.debugmode){h.debug()}h.uid=f.waypoints.length;f.waypoints.push(h);if(!f.applied){f.queue.push(h)}})}}},scrollTo:function(e){var f=this;if(e instanceof b){if(e.uid>=this.waypoints.length){return}var g={y:e.offset.top,x:e.offset.left}}else{g=e}if(!!~navigator.userAgent.indexOf("Chrome")){$(document.body).stop().animate({scrollTop:g.y,scrollLeft:g.x},2000,function(){f.update()})}else{$(document.documentElement).stop().animate({scrollTop:g.y,scrollLeft:g.x},2000,function(){f.update()})}},onScroll:function(){},onWaypointChanged:function(){},onLoad:function(){}};return new a()})();